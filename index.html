<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <title>Document</title>

    <style>
        .inputs-wrapper {
            display: grid;
            justify-content: center;
        }
        

    </style>
</head>
<body>

    <div class="container mt-5 pt-5">
        <div class="row justify-content-center">
            <div class="col-10">
                <form action="row" id="wrapper_input_fields">
                    <div class="col-12 component-wrapper inputs-wrapper inputs-wrapper-active fade sr-only" id="A" data-wedding-url="#currentComponent=1">
                        <label>
                            <span class="d-block text-danger font-weight-bold">Component A</span>

                            <input type="text" class="form-control wd-input-field" value="" id="componentOne" required>
                        </label>
                        
                       <!--  <p> -->
                            <a href="#currentComponent=2" class="btn btn-danger">Submit value</a>
                        <!-- </p> -->
                    </div>

                    <div class="col-12 component-wrapper inputs-wrapper fade sr-only" id="B" data-wedding-url="#currentComponent=2">
                        <label>
                            <span class="d-block text-success font-weight-bold">Component B</span>

                            <input type="text" class="form-control wd-input-field" value="" required>
                        </label>
                        
                       <!--  <p> -->
                            <a href="#currentComponent=3" class="btn btn-success">Submit value</a>
                        <!-- </p> -->
                    </div>

                    <div class="col-12 component-wrapper inputs-wrapper fade sr-only" id="C" data-wedding-url="#currentComponent=3">
                        <label>
                            <span class="d-block text-info font-weight-bold">Component C</span>

                            <input type="text" class="form-control wd-input-field" value="" required>
                        </label>
                        
                       <!--  <p> -->
                            <a href="#currentComponent=4" class="btn btn-info">Submit value</a>
                        <!-- </p> -->
                    </div>

                    <div class="col-12 component-wrapper inputs-wrapper fade sr-only" id="D" data-wedding-url="#currentComponent=4">
                        <label>
                            <span class="d-block text-primary font-weight-bold">Component D</span>

                            <input type="text" class="form-control wd-input-field" value="" required>
                        </label>
                        
                       <!--  <p> -->
                            <a href="#" class="btn btn-primary">Submit value</a>
                        <!-- </p> -->
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script>

        // function to display current component
        const showingElement = ( element ) => {
            ( element.classList.contains( 'sr-only' ) && ! element.classList.contains( 'show' ) ) 

            && element.classList.remove( 'sr-only' ); element.classList.add( 'show' );
        }

        const removingElement = ( element ) => {

            ( element.classList.contains( 'show' ) && ! element.classList.contains( 'sr-only' ) )

                && element.classList.remove( 'show' ); element.classList.add( 'sr-only' );
        }

        console.log( localStorage.getItem( 'myWeddingToolData' ) );
        // hardcode hash when user get into this component for the first time
        window.location = '#currentComponent=1';

        // show element corresponding bar url hash
        let elementToShow = document.querySelector( '[data-wedding-url="#currentComponent=1"]' );
        showingElement( elementToShow );

        // clicking button event
        document.addEventListener( 'click', ( event ) => {

            if( event.target.classList.contains( 'btn' ) ) {

                event.preventDefault();

                let myBtn = event.target;

                console.log( myBtn.previousSibling );

                // store on local storage
                let hrefAttributeClickedButton = event.target.getAttribute( 'href' );

                window.location = hrefAttributeClickedButton;

                let componentToredirectTo = document.querySelector( `[data-wedding-url="${hrefAttributeClickedButton}"]` );
                showingElement( componentToredirectTo );


                let elementToHide = event.target.closest( '.inputs-wrapper' );

                removingElement( elementToHide );

                // Get the existing data
                let existing = localStorage.getItem('myWeddingToolData');

                // If no existing data, create an array
                // Otherwise, convert the localStorage string to an array
                existing = existing ? existing.split(',') : [];

                if( ! existing[hrefAttributeClickedButton] ) {
                        
                    // Add new data to localStorage Array
                    existing.push( hrefAttributeClickedButton );

                    // Save back to localStorage
                    localStorage.setItem('myWeddingToolData', existing.toString());
                }
            }
        } );

    window.addEventListener( 'hashchange', ( event ) => {
        let currentHash = window.location.hash;

        let elementToShow = document.querySelector( `[data-wedding-url="${currentHash}"]` );

        let inputsFields = document.getElementsByClassName( 'inputs-wrapper' );

        Array.from( inputsFields ).map( ( value, index ) => {

            let urlAttribute = value.getAttribute( 'data-wedding-url' )

            if( currentHash != urlAttribute ) { 
                removingElement( value );
             }
        } )
        showingElement( elementToShow );

    } );
    

      










        

        //console.log( currentStateComponent );



        // Set this url by default
        


       

        //console.log( initialHistoryObject );


       

        // Triggered when the url changes
        //window.addEventListener( 'popstate', () => {

            // Check the current component, regarding the url hash
          //  let elementToShow = window.location.hash;

            // now we display that element
            //elementToShow = document.querySelector( `[data-wedding-url="${elementToShow}"]` );
            //showingElement( elementToShow );

            //console.log( history );

        //} );




       
        /*
        
        let element = document.querySelector( '.js-inputs-wrapper-active' );

        let currentLocationUrl = window.location;


        const showingElement = ( element ) => {

            ( element.classList.contains( 'sr-only' ) && ! element.classList.contains( 'show' ) ) 

                && element.classList.remove( 'sr-only' ); element.classList.add( 'show' );
        }

        const removingElement = ( element ) => {

            ( element.classList.contains( 'show' ) && ! element.classList.contains( 'sr-only' ) )

                && element.classList.remove( 'show' ); element.classList.add( 'sr-only' );
        }

        const componentsCollection = {
            A: {
                url: `${currentLocationUrl}currentComponent=1`
            },
            B: {
                url: `${currentLocationUrl}currentComponent=2`
            },
            C: {
                url: `${currentLocationUrl}currentComponent=3`
            },
            D: {
                url: `${currentLocationUrl}currentComponent=3`
            }
        };

        
        let hashUrl = window.location.hash;

        const elementToShow = document.querySelector( `[data-wedding-url="${hashUrl}"]` );

        showingElement( elementToShow );

        document.querySelector( '#wrapper_input_fields' ).addEventListener( 'click', function( event ) {

            if( event.target.classList.contains( 'btn' ) ) {


                let urlLocationNextStep = event.target.getAttribute( 'href' );

                // Passing new location to url bar
                //window.location = urlLocationNextStep;

                const testObject = {
                    entry: urlLocationNextStep
                }

                let newLocation = `${currentLocationUrl.origin}/${urlLocationNextStep}`;

                let componentContainer = event.target.closest( `[data-wedding-url="${urlLocationNextStep}"]` );

                history.pushState( testObject, '', urlLocationNextStep );

                const historyEntryState = history.state.entry;

                console.log( history );

                // if the current url is the one that was on the previous component button.
                // we hide that previous component
                //if( currentLocationUrl.href == newLocation ) {
                    //console.log( componentContainer );

                    //removingElement( componentContainer );

                    // Show next element
                    //let nextElementContainer = componentContainer.nextElementSibling;

                    //showingElement( nextElementContainer );

                //}

                //console.log( currentLocationUrl.hash );

                //console.log( urlLocationNextStep );
                



                //const urlCollection = Object.values( componentsCollection );


                /*
                urlCollection.map( ( value, index ) => {

                    if( history.state.entry == value.url ) {

                        console.log( 'it is the same' );

                        //showingElement( value.url );

                    }

                } );
  
                 */
               // }


    //} );

        //} );

    </script>
</body>
</html>